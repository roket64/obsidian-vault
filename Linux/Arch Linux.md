# Pacman

### 명령어

### 1. `-S, --sync`

#### 동작

`-S` 옵션은 시스템에 꾸러미를 설치하거나 원격 저장소의 꾸러미를 검색하는 데 사용합니다.

#### 옵션 
- `-i, --info`: 원격 저장소의 꾸러미 정보를 봅니다. (`-ii`의 경우 더 많은 정보를 표시합니다.)
- `-s, --search`: 정규식으로 원격 저장소의 꾸러미를 검색합니다. (꾸러미 이름과 설명 모두를 포함하여 검색합니다.)
- `-u, --sysupgrade`: 설치된 모든 꾸러미를 업그레이드합니다. (`-uu`를 사용하면 다운그레이드가 가능합니다.)
- `-y, --refresh`: 서버로부터 새로운 꾸러미 데이터베이스를 받아옵니다. (`-yy`를 사용하면 이미 최신이더라도 강제로 갱신합니다.)

#### 예시
- `pacman -S (package) ...`: 하나 이상의 꾸러미를 의존성과 함께 설치합니다.
- `pacman -Syu`: 새로운 데이터베이스를 받아오고, 설치된 꾸러미를 모두 업그레이드합니다.
- `pacman -Si (package)`: 원격 저장소의 꾸러미 정보를 봅니다.
- `pacman -Ss (regex)`: 원격 저장소에서 정규식으로 꾸러미를 검색합니다.

### 2. `-R, --remove`
#### 동작
`-R` 옵션은 시스템에서 꾸러미를 제거하는 데 사용합니다.

#### 옵션
 - `-c, --cascade`: 명시한 꾸러미와 해당 꾸러미를 의존성으로 가지는 모든 꾸러미를 제거합니다.
 - `-s, --recursive`: 명시한 꾸러미와 해당 꾸러미의 의존성을 모두 제거합니다. 단, 다른 꾸러미의 의존성이나 명시적으로 설치된 것은 제외됩니다.
 - `-u, --unneeded`: 다른 꾸러미의 의존성이 아닌 모든 꾸러미를 제거합니다.
 
#### 예시 
- `pacman -R (package)`: 꾸러미를 제거합니다. 의존성은 제거하지 않습니다.
- `pacman -Rs (package)`:  꾸러미를 의존성과 함께 제거합니다. 다른 꾸러미의 의존성이나 명시적으로 설치된 것은 제외합니다.
- `pacman -Rsu (package)`: 꾸러미와 꾸러미의 그룹에 포함된 다른 꾸러미도 함께 제거합니다.

>[!WARNING]
> 이 명령어로 그룹 꾸러미를 제거할 때, 그룹의 꾸러미들은 모두 개별적인 것으로 간주되며, 설치가 의존적이었든 명시적이었든 모두 제거됩니다. 다만 다른 꾸러미의 의존성은 제거되지 않습니다.

- `pacman -Rsc (package_name)`: 꾸러미와 의존성, 해당 꾸러미를 의존성으로 가지는 꾸러미를 모두 제거합니다.

>[!WARNING]
> 이 명령어는  잠재적으로 필요한 꾸러미를 제거할 위험이 있습니다.
### 3. `-Q, --query`

#### 동작
`-Q` 옵션은 로컬 시스템에서 꾸러미를 검색하는 데 사용합니다.

#### 옵션
 - `-e, --excplicit`: 사용자가 명시적으로 설치한 꾸러미를 검색합니다.
 - `-d, --deps`: 의존성에 따라 설치된 꾸러미를 검색합니다.
 - `-i, --info`: 꾸러미의 정보를 봅니다.
 - `-l, --list`: 꾸러미에 포함된 파일을 나열합니다.
 - `-s, --search`: 정규식으로 로컬 저장소의 꾸러미를 검색합니다.
 - `-t, --unrequired`: 다른 꾸러미의 의존성이 아닌 꾸러미를 검색합니다.
 
#### 예시
- `pacman -Qs (package)`: 로컬에 설치된 꾸러미를 검색합니다.
- `pacman -Qi (package)`: 로컬에 설치된 꾸러미의 정보를 봅니다.
- `pacman -Ql (package)`: 로컬에 설치된 꾸러미에 포함된 파일들을 나열합니다.
- `pacman -Qdt (package)`: 더 이상 다른 꾸러미의 의존성이 아닌 꾸러미들을 나열합니다.
- `pacman -Qet (package)`: 의존성이 아니면서 명시적으로 설치된 꾸러미들을 나열합니다.

### Pactree
*pactree*는 [`pacman-contrib`](https://archlinux.org/packages/?name=pacman-contrib)에 포함된 꾸러미입니다. 해당 꾸러미를 이용해 의존성 의존성 트리를 표시할 수 있습니다.

```shell
pactree (package)
```

```zsh
$ pactree glibc
glibc
├─linux-api-headers>=4.10
├─tzdata
└─filesystem
  └─iana-etc
```
### Paccache

*pacman*은 `/var/cache/pacman/pkg`에 캐시를 저장하지만, 오래되거나 제거된 패키지들의 캐시를 자동으로 삭제하지는 않습니다. [`pacman-contrib`](https://archlinux.org/packages/?name=pacman-contrib)에 포함된 *paccache*를 통해 이러한 캐시를 관리할 수 있습니다.
#### 예시 
- `paccache -r`: 가장 최근의 세 개를 제외하고 저장된 *모든* 캐시된 버전을 삭제합니다. 
- `systemctl enable paccache.timer`: `paccache.timer` 서비스를 활성화하여 일주일마다 사용하지 않는 패키지의 캐시를 모두 버립니다. `/etc/conf.d/pacman-contrib`에서 매개변수를 조정할 수 있습니다.
- `paccache -rk`: 최근의 캐시를 몇 개까지 저장할 지 결정합니다. 가령, `-rk1`은 마지막으로 저장된 하나의 버전만을 유지합니다.
- `paccache -ruk`: `-u, --uninstalled`플래그는 *paccache*가 *제거된* 꾸러미들에 대해서만 동작하도록 제한합니다. 가령, `paccache -ruk0`는 제거된 꾸러미들의 모든 캐시된 버전을 제거합니다.

추가적으로, 시스템에서 제거되거나 사용되지 않는 싱크 데이터베이스를 제거하려면 다음 명령어를 사용할 수 있습니다.

```
pacman -Sc
```

 로컬 캐시를 매우 적극적으로 제거하기 위해서 다음 명령어를 사용할 수 있습니다.  해당 명령어는 캐시 디렉토리의 *모든* 것들을 삭제합니다.

```
pacman -Scc
```

>[!WARNING]
> 디스크 공간을 급히 확보해야 하는 것이 아닌 이상 설치된 패키지의 모든 과거 버전을 제거하는 것은 피하십시오. 이후 꾸러미를 다시 설치하거나 다운그레이드 할 때, 꾸러미 전체를 다시 다운로드해야만 합니다.

